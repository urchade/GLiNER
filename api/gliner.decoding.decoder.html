<!DOCTYPE html>
<html lang="en" data-accent-color="violet" data-content_root="../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>gliner.decoding.decoder module - Home 0.2.24 documentation</title><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="gliner.decoding.utils module" href="gliner.decoding.utils.html" /><link rel="prev" title="gliner.decoding.trie.python_labels_trie module" href="gliner.decoding.trie.python_labels_trie.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=e1a1ceaf" />
    <link rel="stylesheet" type="text/css" href="../_static/shibuya.css?v=d140fbf8" />
    <link media="print" rel="stylesheet" type="text/css" href="../_static/print.css?v=20ff2c19" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/><meta property="og:title" content="gliner.decoding.decoder module"/>
<meta name="twitter:card" content="summary"/>
  </head>
<body><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="../index.html">
      
      
      <strong>Home</strong>
    </a>
    <div class="sy-head-nav" id="head-nav">
      <nav class="sy-head-links"></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="sy-head-socials"></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="head-nav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2"></span>
          <span class="hamburger_3"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="0"><p class="caption" role="heading" aria-level="3"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction to ðŸ‘‘ GLiNER</a></li>
<li class="toctree-l1"><a class="reference internal" href="../instalation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configs.html">Components &amp; Configs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architectures.html">Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../convert_to_onnx.html">ONNX Export &amp; Deployment</a></li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gliner.model.html">gliner.model module</a></li>
<li class="toctree-l1"><a class="reference internal" href="gliner.config.html">gliner.config module</a></li>
<li class="toctree-l1"><a class="reference internal" href="gliner.training.html">gliner.training package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gliner.training.trainer.html">gliner.training.trainer module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gliner.modeling.html">gliner.modeling package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.multitask.html">gliner.modeling.multitask package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gliner.modeling.multitask.relations_layers.html">gliner.modeling.multitask.relations_layers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="gliner.modeling.multitask.triples_layers.html">gliner.modeling.multitask.triples_layers module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.base.html">gliner.modeling.base module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.decoder.html">gliner.modeling.decoder module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.encoder.html">gliner.modeling.encoder module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.layers.html">gliner.modeling.layers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.loss_functions.html">gliner.modeling.loss_functions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.outputs.html">gliner.modeling.outputs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.scorers.html">gliner.modeling.scorers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.span_rep.html">gliner.modeling.span_rep module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.modeling.utils.html">gliner.modeling.utils module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gliner.data_processing.html">gliner.data_processing package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gliner.data_processing.collator.html">gliner.data_processing.collator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.data_processing.processor.html">gliner.data_processing.processor module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.data_processing.tokenizer.html">gliner.data_processing.tokenizer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.data_processing.utils.html">gliner.data_processing.utils module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gliner.evaluation.html">gliner.evaluation package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gliner.evaluation.evaluate_ner.html">gliner.evaluation.evaluate_ner module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.evaluation.evaluator.html">gliner.evaluation.evaluator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.evaluation.utils.html">gliner.evaluation.utils module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gliner.onnx.html">gliner.onnx package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gliner.onnx.model.html">gliner.onnx.model module</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="gliner.decoding.html">gliner.decoding package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gliner.decoding.trie.html">gliner.decoding.trie package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gliner.decoding.trie.labels_trie.html">gliner.decoding.trie.labels_trie module</a></li>
<li class="toctree-l3"><a class="reference internal" href="gliner.decoding.trie.python_labels_trie.html">gliner.decoding.trie.python_labels_trie module</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">gliner.decoding.decoder module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gliner.decoding.utils.html">gliner.decoding.utils module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gliner.utils.html">gliner.utils module</a></li>
</ul>

        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3><ul>
<li><a class="reference internal" href="#gliner.decoding.decoder.BaseDecoder"><code class="docutils literal notranslate"><span class="pre">BaseDecoder</span></code></a><ul>
<li><a class="reference internal" href="#gliner.decoding.decoder.BaseDecoder.__init__"><code class="docutils literal notranslate">__init__()</span></code></a></li>
<li><a class="reference internal" href="#gliner.decoding.decoder.BaseDecoder.decode"><code class="docutils literal notranslate">decode()</span></code></a></li>
<li><a class="reference internal" href="#gliner.decoding.decoder.BaseDecoder.greedy_search"><code class="docutils literal notranslate">greedy_search()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gliner.decoding.decoder.BaseSpanDecoder"><code class="docutils literal notranslate"><span class="pre">BaseSpanDecoder</span></code></a><ul>
<li><a class="reference internal" href="#gliner.decoding.decoder.BaseSpanDecoder.decode"><code class="docutils literal notranslate">decode()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gliner.decoding.decoder.SpanDecoder"><code class="docutils literal notranslate"><span class="pre">SpanDecoder</span></code></a></li>
<li><a class="reference internal" href="#gliner.decoding.decoder.SpanGenerativeDecoder"><code class="docutils literal notranslate"><span class="pre">SpanGenerativeDecoder</span></code></a><ul>
<li><a class="reference internal" href="#gliner.decoding.decoder.SpanGenerativeDecoder.decode_generative"><code class="docutils literal notranslate">decode_generative()</span></code></a></li>
<li><a class="reference internal" href="#gliner.decoding.decoder.SpanGenerativeDecoder.decode"><code class="docutils literal notranslate">decode()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gliner.decoding.decoder.SpanRelexDecoder"><code class="docutils literal notranslate"><span class="pre">SpanRelexDecoder</span></code></a><ul>
<li><a class="reference internal" href="#gliner.decoding.decoder.SpanRelexDecoder.decode"><code class="docutils literal notranslate">decode()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gliner.decoding.decoder.TokenDecoder"><code class="docutils literal notranslate"><span class="pre">TokenDecoder</span></code></a><ul>
<li><a class="reference internal" href="#gliner.decoding.decoder.TokenDecoder.decode"><code class="docutils literal notranslate">decode()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gliner.decoding.decoder.TokenRelexDecoder"><code class="docutils literal notranslate"><span class="pre">TokenRelexDecoder</span></code></a><ul>
<li><a class="reference internal" href="#gliner.decoding.decoder.TokenRelexDecoder.decode"><code class="docutils literal notranslate">decode()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gliner.decoding.decoder.TokenGenerativeDecoder"><code class="docutils literal notranslate"><span class="pre">TokenGenerativeDecoder</span></code></a><ul>
<li><a class="reference internal" href="#gliner.decoding.decoder.TokenGenerativeDecoder.decode_generative"><code class="docutils literal notranslate">decode_generative()</span></code></a></li>
<li><a class="reference internal" href="#gliner.decoding.decoder.TokenGenerativeDecoder.decode"><code class="docutils literal notranslate">decode()</span></code></a></li>
</ul>
</li>
</ul>
</div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">Home</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="gliner.decoding.html"><span itemprop="name">gliner.decoding package</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">gliner.decoding.decoder module</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
        <article class="yue" role="main">
          <section id="module-gliner.decoding.decoder">
<span id="gliner-decoding-decoder-module"></span><h1>gliner.decoding.decoder module<a class="headerlink" href="#module-gliner.decoding.decoder" title="Link to this heading">Â¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="gliner.decoding.decoder.BaseDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gliner.decoding.decoder.</span></span><span class="sig-name descname"><span class="pre">BaseDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#BaseDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.BaseDecoder" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for all decoders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> â€“ Configuration object containing decoder parameters.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.BaseDecoder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#BaseDecoder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.BaseDecoder.__init__" title="Link to this definition">Â¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.BaseDecoder.decode">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#BaseDecoder.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.BaseDecoder.decode" title="Link to this definition">Â¶</a></dt>
<dd><p>Decode model output into structured predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Variable positional arguments.</p></li>
<li><p><strong>**kwargs</strong> â€“ Variable keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Decoded predictions in the appropriate format.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.BaseDecoder.greedy_search">
<span class="sig-name descname"><span class="pre">greedy_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_ner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#BaseDecoder.greedy_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.BaseDecoder.greedy_search" title="Link to this definition">Â¶</a></dt>
<dd><p>Perform greedy search to remove overlapping spans.</p>
<p>Sorts spans by confidence score (descending) and keeps only non-overlapping
spans according to the specified NER mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spans</strong> (<em>List</em><em>[</em><em>tuple</em><em>]</em>) â€“ List of span tuples containing at minimum
(start, end, â€¦, score).</p></li>
<li><p><strong>flat_ner</strong> (<em>bool</em>) â€“ Whether to use flat NER (no nesting allowed) or
nested NER (allows nesting).</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em>) â€“ Whether to allow multiple labels for the same
span position.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered list of non-overlapping spans, sorted by start position.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[tuple]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gliner.decoding.decoder.BaseSpanDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gliner.decoding.decoder.</span></span><span class="sig-name descname"><span class="pre">BaseSpanDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#BaseSpanDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.BaseSpanDecoder" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gliner.decoding.decoder.BaseDecoder" title="gliner.decoding.decoder.BaseDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDecoder</span></code></a></p>
<p>Base class for span-based decoders with common decoding logic.</p>
<p>Provides shared functionality for finding candidate spans, validating them,
and decoding batch items.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.BaseSpanDecoder.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_to_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_ner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#BaseSpanDecoder.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.BaseSpanDecoder.decode" title="Link to this definition">Â¶</a></dt>
<dd><p>Decode model output to extract named entity spans.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokens</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) â€“ Tokenized input text for each sample in the batch.</p></li>
<li><p><strong>id_to_classes</strong> (<em>Union</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>]</em><em>]</em>) â€“ Mapping from
class IDs to class names. Can be a single dict (shared) or list (per-sample).</p></li>
<li><p><strong>model_output</strong> (<em>torch.Tensor</em>) â€“ Raw logits from the model with shape (B, L, K, C),
where B is batch size, L is sequence length, K is max span width,
C is number of classes.</p></li>
<li><p><strong>flat_ner</strong> (<em>bool</em>) â€“ Whether to enforce non-overlapping spans.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â€“ Confidence threshold for span predictions.</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em>) â€“ Whether to allow multiple labels per span.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments (unused in base class).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>For each sample in batch, list of span tuples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[tuple]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gliner.decoding.decoder.SpanDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gliner.decoding.decoder.</span></span><span class="sig-name descname"><span class="pre">SpanDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#SpanDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.SpanDecoder" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gliner.decoding.decoder.BaseSpanDecoder" title="gliner.decoding.decoder.BaseSpanDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSpanDecoder</span></code></a></p>
<p>Simple span decoder without generative labels.</p>
<p>Returns spans in format: (start, end, entity_type, score)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gliner.decoding.decoder.SpanGenerativeDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gliner.decoding.decoder.</span></span><span class="sig-name descname"><span class="pre">SpanGenerativeDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#SpanGenerativeDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.SpanGenerativeDecoder" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gliner.decoding.decoder.BaseSpanDecoder" title="gliner.decoding.decoder.BaseSpanDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSpanDecoder</span></code></a></p>
<p>Span decoder with generative label support.</p>
<p>Supports two decoder modes:
- â€˜promptâ€™: Generated labels replace the original class names
- â€˜spanâ€™: Generated labels are added as additional fields to each span</p>
<p>Returns spans in format: (start, end, entity_type, generated_entity_type, score)</p>
<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.SpanGenerativeDecoder.decode_generative">
<span class="sig-name descname"><span class="pre">decode_generative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_to_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gen_sequences</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_ner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#SpanGenerativeDecoder.decode_generative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.SpanGenerativeDecoder.decode_generative" title="Link to this definition">Â¶</a></dt>
<dd><p>Decode model output with generated labels.</p>
<p>Handles both â€˜promptâ€™ and â€˜spanâ€™ decoder modes:
- prompt mode: Generated labels replace class names in id_to_classes
- span mode: Generated labels are added to span tuples via span_label_map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokens</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) â€“ Tokenized input text for each sample in the batch.</p></li>
<li><p><strong>id_to_classes</strong> (<em>Union</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>]</em><em>]</em>) â€“ Mapping from
class IDs to class names.</p></li>
<li><p><strong>model_output</strong> (<em>torch.Tensor</em>) â€“ Raw logits from the model with shape (B, L, K, C).</p></li>
<li><p><strong>gen_labels</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) â€“ Generated labels from the decoder, flattened across batch.</p></li>
<li><p><strong>sel_idx</strong> (<em>Optional</em><em>[</em><em>torch.LongTensor</em><em>]</em>) â€“ Tensor of shape (B, M) with selected
span indices. Required for span mode, unused for prompt mode.</p></li>
<li><p><strong>num_gen_sequences</strong> (<em>int</em>) â€“ Number of label sequences generated per span.</p></li>
<li><p><strong>flat_ner</strong> (<em>bool</em>) â€“ Whether to enforce non-overlapping spans.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â€“ Confidence threshold for span predictions.</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em>) â€“ Whether to allow multiple labels per span.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>For each sample, list of span tuples with generated labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[tuple]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.SpanGenerativeDecoder.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_to_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_ner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gen_sequences</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#SpanGenerativeDecoder.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.SpanGenerativeDecoder.decode" title="Link to this definition">Â¶</a></dt>
<dd><p>Decode model output, with optional generative label support.</p>
<p>If gen_labels are provided and decoder has a labels_decoder, uses generative
decoding. Otherwise falls back to standard span decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokens</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) â€“ Tokenized input text for each sample in the batch.</p></li>
<li><p><strong>id_to_classes</strong> (<em>Union</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>]</em><em>]</em>) â€“ Mapping from
class IDs to class names.</p></li>
<li><p><strong>model_output</strong> (<em>torch.Tensor</em>) â€“ Raw logits from the model with shape (B, L, K, C).</p></li>
<li><p><strong>flat_ner</strong> (<em>bool</em>) â€“ Whether to enforce non-overlapping spans.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â€“ Confidence threshold for span predictions.</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em>) â€“ Whether to allow multiple labels per span.</p></li>
<li><p><strong>gen_labels</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) â€“ Generated labels from decoder. If provided,
triggers generative decoding.</p></li>
<li><p><strong>sel_idx</strong> (<em>Optional</em><em>[</em><em>torch.LongTensor</em><em>]</em>) â€“ Selected span indices for span mode.</p></li>
<li><p><strong>num_gen_sequences</strong> (<em>int</em>) â€“ Number of label sequences generated per span.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments (unused).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>For each sample, list of span tuples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[tuple]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gliner.decoding.decoder.SpanRelexDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gliner.decoding.decoder.</span></span><span class="sig-name descname"><span class="pre">SpanRelexDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#SpanRelexDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.SpanRelexDecoder" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gliner.decoding.decoder.BaseSpanDecoder" title="gliner.decoding.decoder.BaseSpanDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSpanDecoder</span></code></a></p>
<p>Span decoder with relation extraction support.</p>
<p>Extends the base span decoder to decode both entity spans and the relations
between them. Entity spans are extracted first using the parent class logic,
then relations are decoded by identifying pairs of entities and their
relationship types based on model predictions.</p>
<p>The decoder supports:
- Entity span extraction with confidence thresholding
- Relation extraction between detected entities
- Flexible entity and relation label mappings (per-sample or global)
- Optional flat NER (non-overlapping entities)
- Multi-label entity classification</p>
<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.SpanRelexDecoder.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_to_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_logits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_ner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_id_to_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#SpanRelexDecoder.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.SpanRelexDecoder.decode" title="Link to this definition">Â¶</a></dt>
<dd><p>Decode model output to extract entities and relations.</p>
<p>Main decoding method that extracts both entity spans and relations from
model outputs. First decodes entity spans using the parent class logic,
then decodes relations between the detected entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokens</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) â€“ Tokenized input text for each sample in the batch.
Each sample is a list of token strings.</p></li>
<li><p><strong>id_to_classes</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>] </em><em>| </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>]</em>) â€“ Mapping from entity class IDs to entity type names.
Can be either:
- Dict: Single mapping used for all samples (global entity schema)
- List[Dict]: Per-sample mappings for different entity schemas
Class IDs are 1-indexed (0 is reserved for padding).</p></li>
<li><p><strong>model_output</strong> â€“ Model output object containing both entity logits and
optionally relation predictions. Must have a logits attribute for
entity extraction. May have rel_idx, rel_logits, and rel_mask for
relation extraction.</p></li>
<li><p><strong>rel_idx</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Optional tensor of shape (batch_size, num_relations, 2) containing
head and tail entity indices for each potential relation.</p></li>
<li><p><strong>rel_logits</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Optional tensor of shape (batch_size, num_relations, num_relation_classes)
containing relation classification logits.</p></li>
<li><p><strong>rel_mask</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Optional boolean tensor of shape (batch_size, num_relations)
indicating valid relations. If None, all relations are considered valid.</p></li>
<li><p><strong>flat_ner</strong> (<em>bool</em>) â€“ If True, applies greedy filtering to ensure non-overlapping
entity spans. If False, allows overlapping entities. Defaults to False.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â€“ Minimum confidence score (0-1) for both entity
predictions to be included in the output. Defaults to 0.5.</p></li>
<li><p><strong>relation_threshold</strong> (<em>float</em>) â€“ Minimum confidence score (0-1) for both relation
predictions to be included in the output. Defaults to 0.5.</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em>) â€“ If True, allows multiple entity types per span. If False,
only the highest-scoring entity type per span is kept. Defaults to False.</p></li>
<li><p><strong>rel_id_to_classes</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>] </em><em>| </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>] </em><em>| </em><em>None</em>) â€“ Optional mapping from relation class IDs to relation names.
If None, relation decoding is skipped and empty relation lists are returned.
Can be either a single Dict or List[Dict] for per-sample mappings.
Class IDs are 1-indexed.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to the parent class decode method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>spans: List of entity span lists, one per sample. Each entity span is
a tuple: (start, end, entity_type, score)</p></li>
<li><p>relations: List of relation lists, one per sample. Each relation is
a tuple: (head_idx, relation_label, tail_idx, score) where head_idx
and tail_idx are indices into the corresponding sampleâ€™s spans list.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of (spans, relations) where</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="gp">&gt;&gt;&gt; </span><span class="n">decoder</span> <span class="o">=</span> <span class="n">SpanRelexDecoder</span><span class="p">()</span>
</span><span data-line="2"><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;works&quot;</span><span class="p">,</span> <span class="s2">&quot;at&quot;</span><span class="p">,</span> <span class="s2">&quot;Microsoft&quot;</span><span class="p">]]</span>
</span><span data-line="3"><span class="gp">&gt;&gt;&gt; </span><span class="n">id_to_classes</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;PERSON&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;ORG&quot;</span><span class="p">}</span>
</span><span data-line="4"><span class="gp">&gt;&gt;&gt; </span><span class="n">rel_id_to_classes</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;works_at&quot;</span><span class="p">}</span>
</span><span data-line="5"><span class="gp">&gt;&gt;&gt; </span><span class="n">spans</span><span class="p">,</span> <span class="n">relations</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
</span><span data-line="6"><span class="gp">... </span>    <span class="n">tokens</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span>
</span><span data-line="7"><span class="gp">... </span>    <span class="n">id_to_classes</span><span class="o">=</span><span class="n">id_to_classes</span><span class="p">,</span>
</span><span data-line="8"><span class="gp">... </span>    <span class="n">model_output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
</span><span data-line="9"><span class="gp">... </span>    <span class="n">rel_id_to_classes</span><span class="o">=</span><span class="n">rel_id_to_classes</span><span class="p">,</span>
</span><span data-line="10"><span class="gp">... </span>    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span data-line="11"><span class="gp">... </span><span class="p">)</span>
</span><span data-line="12"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># spans[0] might be: [(0, 1, &quot;PERSON&quot;, 0.9), (3, 4, &quot;ORG&quot;, 0.85)]</span>
</span><span data-line="13"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># relations[0] might be: [(0, &quot;works_at&quot;, 1, 0.8)]</span>
</span></pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gliner.decoding.decoder.TokenDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gliner.decoding.decoder.</span></span><span class="sig-name descname"><span class="pre">TokenDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#TokenDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.TokenDecoder" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gliner.decoding.decoder.BaseDecoder" title="gliner.decoding.decoder.BaseDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDecoder</span></code></a></p>
<p>Token-based decoder for sequence labeling tasks.</p>
<p>Uses BIO-style tagging with separate start, end, and inside predictions
to identify entity spans. Can also decode from span-level predictions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.TokenDecoder.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_to_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_ner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_logits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#TokenDecoder.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.TokenDecoder.decode" title="Link to this definition">Â¶</a></dt>
<dd><p>Decode predictions to extract spans.</p>
<p>Supports two decoding modes:
1. Token-level BIO decoding (default): Uses model_output with start/end/inside predictions
2. Span-level decoding: Uses span_logits, span_idx, and span_mask</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokens</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) â€“ Tokenized input text for each sample in the batch.</p></li>
<li><p><strong>id_to_classes</strong> (<em>Union</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>]</em><em>]</em>) â€“ Mapping from
class IDs to class names.</p></li>
<li><p><strong>model_output</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Raw logits from the model with shape
(B, L, C, 3), where the last dimension represents [start, end, inside]
predictions. Used for token-level decoding.</p></li>
<li><p><strong>flat_ner</strong> (<em>bool</em>) â€“ Whether to enforce non-overlapping spans.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â€“ Confidence threshold for predictions.</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em>) â€“ Whether to allow multiple labels per span.</p></li>
<li><p><strong>span_logits</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Span classification logits with shape
(B, S, C). Used for span-level decoding.</p></li>
<li><p><strong>span_idx</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Span indices with shape (B, S, 2).
Used for span-level decoding.</p></li>
<li><p><strong>span_mask</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Boolean mask with shape (B, S).
Used for span-level decoding.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments (unused).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>For each sample, list of span tuples in format</dt><dd><p>(start, end, entity_type, None, score).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[tuple]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> â€“ If neither model_output nor span-level inputs are provided,
    or if span-level inputs are incomplete.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gliner.decoding.decoder.TokenRelexDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gliner.decoding.decoder.</span></span><span class="sig-name descname"><span class="pre">TokenRelexDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#TokenRelexDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.TokenRelexDecoder" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gliner.decoding.decoder.TokenDecoder" title="gliner.decoding.decoder.TokenDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">TokenDecoder</span></code></a></p>
<p>Token-based decoder with relation extraction support.</p>
<p>Extends the token-based BIO decoder to decode both entity spans and the relations
between them. Entity spans are extracted first using BIO-style tagging logic,
then relations are decoded by identifying pairs of entities and their
relationship types based on model predictions.</p>
<p>The decoder supports:
- Entity span extraction via BIO tagging with confidence thresholding
- Relation extraction between detected entities
- Flexible entity and relation label mappings (per-sample or global)
- Optional flat NER (non-overlapping entities)
- Multi-label entity classification</p>
<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.TokenRelexDecoder.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_to_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_logits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_ner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_id_to_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#TokenRelexDecoder.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.TokenRelexDecoder.decode" title="Link to this definition">Â¶</a></dt>
<dd><p>Decode model output to extract entities and relations.</p>
<p>Main decoding method that extracts both entity spans and relations from
model outputs. First decodes entity spans using BIO-style token tagging,
then decodes relations between the detected entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokens</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) â€“ Tokenized input text for each sample in the batch.
Each sample is a list of token strings.</p></li>
<li><p><strong>id_to_classes</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>] </em><em>| </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>]</em>) â€“ Mapping from entity class IDs to entity type names.
Can be either:
- Dict: Single mapping used for all samples (global entity schema)
- List[Dict]: Per-sample mappings for different entity schemas
Class IDs are 1-indexed (0 is reserved for padding).</p></li>
<li><p><strong>model_output</strong> (<em>Tensor</em>) â€“ Model output tensor with shape (B, L, C, 3) where the last
dimension contains [start, end, inside] predictions for BIO tagging.</p></li>
<li><p><strong>rel_idx</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Optional tensor of shape (batch_size, num_relations, 2) containing
head and tail entity indices for each potential relation.</p></li>
<li><p><strong>rel_logits</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Optional tensor of shape (batch_size, num_relations, num_relation_classes)
containing relation classification logits.</p></li>
<li><p><strong>rel_mask</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Optional boolean tensor of shape (batch_size, num_relations)
indicating valid relations. If None, all relations are considered valid.</p></li>
<li><p><strong>flat_ner</strong> (<em>bool</em>) â€“ If True, applies greedy filtering to ensure non-overlapping
entity spans. If False, allows overlapping entities. Defaults to False.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â€“ Minimum confidence score (0-1) for entity predictions
to be included in the output. Defaults to 0.5.</p></li>
<li><p><strong>relation_threshold</strong> (<em>float</em>) â€“ Minimum confidence score (0-1) for relation
predictions to be included in the output. Defaults to 0.5.</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em>) â€“ If True, allows multiple entity types per span. If False,
only the highest-scoring entity type per span is kept. Defaults to False.</p></li>
<li><p><strong>rel_id_to_classes</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>] </em><em>| </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>] </em><em>| </em><em>None</em>) â€“ Optional mapping from relation class IDs to relation names.
If None, relation decoding is skipped and empty relation lists are returned.
Can be either a single Dict or List[Dict] for per-sample mappings.
Class IDs are 1-indexed.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to the parent class decode method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>spans: List of entity span lists, one per sample. Each entity span is
a tuple: (start, end, entity_type, score)</p></li>
<li><p>relations: List of relation lists, one per sample. Each relation is
a tuple: (head_idx, relation_label, tail_idx, score) where head_idx
and tail_idx are indices into the corresponding sampleâ€™s spans list.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of (spans, relations) where</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="gp">&gt;&gt;&gt; </span><span class="n">decoder</span> <span class="o">=</span> <span class="n">TokenRelexDecoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span data-line="2"><span class="gp">&gt;&gt;&gt; </span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;works&quot;</span><span class="p">,</span> <span class="s2">&quot;at&quot;</span><span class="p">,</span> <span class="s2">&quot;Microsoft&quot;</span><span class="p">]]</span>
</span><span data-line="3"><span class="gp">&gt;&gt;&gt; </span><span class="n">id_to_classes</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;PERSON&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;ORG&quot;</span><span class="p">}</span>
</span><span data-line="4"><span class="gp">&gt;&gt;&gt; </span><span class="n">rel_id_to_classes</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;works_at&quot;</span><span class="p">}</span>
</span><span data-line="5"><span class="gp">&gt;&gt;&gt; </span><span class="n">spans</span><span class="p">,</span> <span class="n">relations</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
</span><span data-line="6"><span class="gp">... </span>    <span class="n">tokens</span><span class="o">=</span><span class="n">tokens</span><span class="p">,</span>
</span><span data-line="7"><span class="gp">... </span>    <span class="n">id_to_classes</span><span class="o">=</span><span class="n">id_to_classes</span><span class="p">,</span>
</span><span data-line="8"><span class="gp">... </span>    <span class="n">model_output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
</span><span data-line="9"><span class="gp">... </span>    <span class="n">rel_id_to_classes</span><span class="o">=</span><span class="n">rel_id_to_classes</span><span class="p">,</span>
</span><span data-line="10"><span class="gp">... </span>    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span data-line="11"><span class="gp">... </span><span class="p">)</span>
</span><span data-line="12"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># spans[0] might be: [(0, 0, &quot;PERSON&quot;, 0.9), (3, 3, &quot;ORG&quot;, 0.85)]</span>
</span><span data-line="13"><span class="gp">&gt;&gt;&gt; </span><span class="c1"># relations[0] might be: [(0, &quot;works_at&quot;, 1, 0.8)]</span>
</span></pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gliner.decoding.decoder.TokenGenerativeDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gliner.decoding.decoder.</span></span><span class="sig-name descname"><span class="pre">TokenGenerativeDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#TokenGenerativeDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.TokenGenerativeDecoder" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gliner.decoding.decoder.TokenDecoder" title="gliner.decoding.decoder.TokenDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">TokenDecoder</span></code></a>, <a class="reference internal" href="#gliner.decoding.decoder.SpanGenerativeDecoder" title="gliner.decoding.decoder.SpanGenerativeDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanGenerativeDecoder</span></code></a></p>
<p>Token-based decoder with generative label support.</p>
<p>Extends the token decoder to support generated labels from an encoder-decoder
architecture. Supports two decoder modes:
- â€˜promptâ€™: Generated labels replace the original class names
- â€˜spanâ€™: Generated labels are added as additional fields to each span</p>
<p>Returns spans in format: (start, end, entity_type, generated_entity_type, score)</p>
<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.TokenGenerativeDecoder.decode_generative">
<span class="sig-name descname"><span class="pre">decode_generative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_to_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gen_sequences</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_ner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_logits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#TokenGenerativeDecoder.decode_generative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.TokenGenerativeDecoder.decode_generative" title="Link to this definition">Â¶</a></dt>
<dd><p>Decode model output with generated labels.</p>
<p>Handles both â€˜promptâ€™ and â€˜spanâ€™ decoder modes:
- prompt mode: Generated labels replace class names in id_to_classes
- span mode: Generated labels are added to span tuples via span_label_map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokens</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) â€“ Tokenized input text for each sample in the batch.</p></li>
<li><p><strong>id_to_classes</strong> (<em>Union</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>]</em><em>]</em>) â€“ Mapping from
class IDs to class names.</p></li>
<li><p><strong>model_output</strong> (<em>torch.Tensor</em>) â€“ Raw logits from the model with shape (B, W, C, 3).</p></li>
<li><p><strong>gen_labels</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) â€“ Generated labels from the decoder, flattened across batch.</p></li>
<li><p><strong>sel_idx</strong> (<em>Optional</em><em>[</em><em>torch.LongTensor</em><em>]</em>) â€“ Tensor of shape (B, M) with selected
span indices. Required for span mode, unused for prompt mode.</p></li>
<li><p><strong>num_gen_sequences</strong> (<em>int</em>) â€“ Number of label sequences generated per span.</p></li>
<li><p><strong>flat_ner</strong> (<em>bool</em>) â€“ Whether to enforce non-overlapping spans.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â€“ Confidence threshold for span predictions.</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em>) â€“ Whether to allow multiple labels per span.</p></li>
<li><p><strong>span_logits</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Span classification logits.</p></li>
<li><p><strong>span_idx</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Span indices.</p></li>
<li><p><strong>span_mask</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Span mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>For each sample, list of span tuples with generated labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[tuple]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gliner.decoding.decoder.TokenGenerativeDecoder.decode">
<span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_to_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_ner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gen_sequences</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_logits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gliner/decoding/decoder.html#TokenGenerativeDecoder.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gliner.decoding.decoder.TokenGenerativeDecoder.decode" title="Link to this definition">Â¶</a></dt>
<dd><p>Decode model output, with optional generative label support.</p>
<p>If gen_labels are provided and decoder has a labels_decoder, uses generative
decoding. Otherwise falls back to standard token decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokens</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) â€“ Tokenized input text.</p></li>
<li><p><strong>id_to_classes</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>] </em><em>| </em><em>List</em><em>[</em><em>Dict</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>]</em>) â€“ Class ID to name mapping.</p></li>
<li><p><strong>model_output</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Token-level logits (B, W, C, 3).</p></li>
<li><p><strong>flat_ner</strong> (<em>bool</em>) â€“ Whether to enforce non-overlapping spans.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â€“ Confidence threshold.</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em>) â€“ Allow multiple labels per span.</p></li>
<li><p><strong>gen_labels</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ Generated labels from decoder.</p></li>
<li><p><strong>sel_idx</strong> (<em>LongTensor</em><em> | </em><em>None</em>) â€“ Selected span indices for span mode.</p></li>
<li><p><strong>num_gen_sequences</strong> (<em>int</em>) â€“ Number of sequences per span.</p></li>
<li><p><strong>span_logits</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Span classification logits.</p></li>
<li><p><strong>span_idx</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Span indices.</p></li>
<li><p><strong>span_mask</strong> (<em>Tensor</em><em> | </em><em>None</em>) â€“ Span mask.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of span tuples, with generated labels if available.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>List</em>[tuple]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="gliner.decoding.trie.python_labels_trie.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">gliner.decoding.trie.python_labels_trie module</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="gliner.decoding.utils.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">gliner.decoding.utils module</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2025, GLiNER community</p>
  
  <p>
    Made with
    
    <a href="https://www.sphinx-doc.org/">Sphinx</a> and
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials"></div>
    </div>
  </div>
</footer>
      <script src="../_static/documentation_options.js?v=dc91f075"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/shibuya.js?v=9b0e4dde"></script></body>
</html>